<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Database on Salman Quazi</title><link>https://www.salmanq.com/tags/database/</link><description>Recent content in Database on Salman Quazi</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><managingEditor>Salman Quazi</managingEditor><lastBuildDate>Sat, 26 May 2007 01:38:29 +0000</lastBuildDate><atom:link href="https://www.salmanq.com/tags/database/index.xml" rel="self" type="application/rss+xml"/><item><title>Using SSIS to Access Network Resources</title><link>https://www.salmanq.com/blog/using-ssis-to-access-network-resources/</link><pubDate>Sat, 26 May 2007 01:38:29 +0000</pubDate><author>Salman Quazi</author><guid>https://www.salmanq.com/blog/using-ssis-to-access-network-resources/</guid><description>&lt;p&gt;SSIS (SQL Server Integration Services) is the replacement for DTS in SQL 2005. One of the more deceitful concepts in SSIS is it&amp;rsquo;s security context. When you run a SSIS package form your Visual Studio Environment, it obviously runs under a different security context (most possibly as you&amp;ndash;the developer) than it would run if it was run as a scheduled service on the SQL server itself. So let&amp;rsquo;s say you&amp;rsquo;ve developed a SSIS package that uses resources within your domain, such as accessing a network drive. How will SSIS access such a resource? As you may know, SSIS packages are executed by the SQL server agent, which by default uses the native [NT AUTHORITY\SYSTEM] account1 to execute your packages. Since this is a local account you cannot use it when you need access to resources external to the SQL server box. In order to access domain level resources, you need to use a domain proxy. A domain proxy allows the SQL agent to proxy on an existing domain account when it executes a package. The first step is to create a credential. Connect to your SQL server, expand security, right click credentials and new credential. Fill-in the dialog box to something like this: &lt;a href="https://www.salmanq.com/2007/05/domainproxy1.jpg" title="SQL 2005 - Credentials"&gt;&lt;img src="https://www.salmanq.com/2007/05/domainproxy1.thumbnail.jpg" alt="SQL 2005 - Credentials"&gt;&lt;/a&gt; The second step is to create a domain proxy, expand SQL Server Agent, right click proxies and click new proxy. Fill in the dialog box something similar to the image shown on the left. Identity is the domain account you are going to use and the password to the domain account.&lt;br&gt;
&lt;a href="https://www.salmanq.com/2007/05/domainproxy2.jpg" title="SQL 2005 - Proxy Accounts"&gt;&lt;img src="https://www.salmanq.com/2007/05/domainproxy2.thumbnail.jpg" alt="SQL 2005 - Proxy Accounts"&gt;&lt;/a&gt; Once this is done, expand SQL Server Agent, right click Proxies and click on New Proxy. The resulting dialog box should look something like the image on the left. For the credential name use the credential you just made.&lt;br&gt;
&lt;a href="https://www.salmanq.com/2007/05/domainproxy3.jpg" title="SQL 2005 - SSIS Run As"&gt;&lt;img src="https://www.salmanq.com/2007/05/domainproxy3.thumbnail.jpg" alt="SQL 2005 - SSIS Run As"&gt;&lt;/a&gt; Now the last step is to modify the SSIS package to use this proxy account. So right click Jobs under SQL Server Agent, right click the job that you want to run using this proxy account, click properties, go to the steps tab, click on edit at the bottom of the screen. Change Run As to the new proxy account you just created. The resulting dialog box should look something like the image on the left. Make sure the domain account, which you are using during the step when you created the credential, has access to all the network resources this package needs access to. [1] SQL Agent actually does not use the system account but runs in the context of the SQLAgentUser group on the local machine, the [NT AUTHORITY\SYSTEM] account is by default part of the SQLAgentUser group.&lt;/p&gt;</description></item><item><title>Script Task reading/returning data</title><link>https://www.salmanq.com/blog/script-task-readingreturning-data/</link><pubDate>Fri, 25 May 2007 23:58:45 +0000</pubDate><author>Salman Quazi</author><guid>https://www.salmanq.com/blog/script-task-readingreturning-data/</guid><description>&lt;p&gt;When you are using the Script Task in SSIS it&amp;rsquo;s often useful to have the script task return data, and also at times useful to have access to external data. Once you drop a Script Task onto the designer and go to it&amp;rsquo;s editor, under the script tab you&amp;rsquo;ll find two attributes: ReadOnlyVariables, ReadWriteVariables. The first allows the script to access external &lt;strong&gt;user variables&lt;/strong&gt; for reading, while the latter allows write access. It&amp;rsquo;s important to realize that we are talking about user variables which is usually under the &lt;em&gt;User::&lt;/em&gt; namespace. So every variable you list must be prefixed by: User::. If you don&amp;rsquo;t the script assumes System::. So here&amp;rsquo;s a screen shot of what a script task might look like: &lt;a href="https://www.salmanq.com/2007/05/script-task1.jpg" title="Script Task (Variables)"&gt;&lt;img src="https://www.salmanq.com/2007/05/script-task1.thumbnail.jpg" alt="Script Task (Variables)"&gt;&lt;/a&gt; Once you click on the design script you get an editor where you are allowed to type VB.NET code. At this point SSIS script tasks do not support C#. Here&amp;rsquo;s a sample of how you can access a user variable and set a value to it. As you can see from the sample code below, SSIS variables are not typed:&lt;/p&gt;</description></item><item><title>Four Part Naming Convention in SQL Server</title><link>https://www.salmanq.com/blog/four-part-naming-convention-in-sql-server/</link><pubDate>Tue, 20 Sep 2005 05:41:16 +0000</pubDate><author>Salman Quazi</author><guid>https://www.salmanq.com/blog/four-part-naming-convention-in-sql-server/</guid><description>&lt;p&gt;In SQL server if you want to reference a table using four-part naming convention and you receive the error message: &lt;strong&gt;Server &amp;lsquo;xxxx&amp;rsquo; is not configured for DATA ACCESS&lt;/strong&gt;. Then you need to execute this statement against the target server:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;EXEC&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sp_serveroption&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;xxxx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DATA ACCESS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="k"&gt;TRUE&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&amp;hellip; that should fix the problem. An obvious point here is to replace xxxx with the target server.&lt;/p&gt;</description></item><item><title>Recursion in SQL</title><link>https://www.salmanq.com/blog/recursion-in-sql/</link><pubDate>Sun, 11 Sep 2005 15:21:31 +0000</pubDate><author>Salman Quazi</author><guid>https://www.salmanq.com/blog/recursion-in-sql/</guid><description>&lt;p&gt;Oracle database supports a very strange construct called: start with, and connect by. For instance if you have a table which has two columns one that defines the parent of the other column such as:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; Parent Child
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="m"&gt;9&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;9&lt;/span&gt; &lt;span class="m"&gt;7&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;7&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The parent of 2 is 7 and 7&amp;rsquo;s parent is nine and 9&amp;rsquo;s parent is one and so on until finally 1 who parent is 0 signifying no parent. To find the root or the top-level parent given an ID cannot be done easily without recursion and SQL server does not support recursion in SQL contructs. But Oracle does, here&amp;rsquo;s how we can solve this problem in Oracle:&lt;/p&gt;</description></item><item><title>MySQL version information</title><link>https://www.salmanq.com/blog/mysql-version-information/</link><pubDate>Thu, 31 Mar 2005 07:32:22 +0000</pubDate><author>Salman Quazi</author><guid>https://www.salmanq.com/blog/mysql-version-information/</guid><description>&lt;p&gt;You can use this simple command to find the MySQL version you are running:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;select&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;Version&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;Version&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Hope that helps.&lt;/p&gt;</description></item><item><title>Object Databases (ORDBMS)</title><link>https://www.salmanq.com/blog/object-databases-ordbms/</link><pubDate>Wed, 10 Nov 2004 19:38:02 +0000</pubDate><author>Salman Quazi</author><guid>https://www.salmanq.com/blog/object-databases-ordbms/</guid><description>&lt;p&gt;ORDBMS - Object Relational, Database Management system. Is an object oriented database management system. The concept at first is a bit suprising since relational database sort of by definition negates the concept of objects. In theory a relational database is a set of relation R; each table, formally known as relations, can be joined (cartesian product) to produce a new relation (which is an improper subset of R1xR2). There are many problems with this scenario. Lets say you want a database that contains sets of points where computers are physically located in a global positioning system. This hypothetical organization contains various departments, a set of departments makes up a local-organization, and a set of local-organization makes up an organization, to make situations worst, each continent can contain several organizations; and there are seven continents. This company is so large they have branches all over the seven continents. The point of this all is to find the minimal net-cost (where cost is distance) for communication between computers. Your product is expected to answers queries of this type:&lt;/p&gt;</description></item></channel></rss>