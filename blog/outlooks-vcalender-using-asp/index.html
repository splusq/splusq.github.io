<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=generator content="Hugo 0.120.0"><meta name=viewport content="width=device-width,initial-scale=1"><title>Outlook’s vCalender using ASP &#183; Salman Quazi</title>
<meta name=description content><link type=text/css rel=stylesheet href=https://www.salmanq.com/css/print.css media=print><link type=text/css rel=stylesheet href=https://www.salmanq.com/css/poole.css><link type=text/css rel=stylesheet href=https://www.salmanq.com/css/syntax.css><link type=text/css rel=stylesheet href=https://www.salmanq.com/css/hyde.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700"><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png><style type=text/css>.sidebar-about h1{font-size:1.95rem;font-weight:400}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-K4WVH5P91F"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-K4WVH5P91F")</script></head><body class=theme-base-08><aside class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://www.salmanq.com/><h1>Salman Quazi</h1></a><p class=lead>Engineering Manager for Microsoft Azure Cognitive Services in Mountain View, CA.</p></div><nav><ul class=sidebar-nav><li><a href=https://www.salmanq.com/>Home</a></li><li><a href=/blog/>Blog</a></li><li><a href=https://github.com/splusq/>Github</a></li><li><a href=https://www.linkedin.com/in/salmanquazi/>LinkedIn</a></li><li><a href=https://www.twitter.com/splusq>Twitter</a></li></ul></nav><p>Opinions are my own.</p></div></aside><main class="content container"><div class=post><h1>Outlook’s vCalender using ASP</h1><time datetime=2004-12-07T03:47:28Z class=post-date>Tue, Dec 7, 2004</time><p>As part of a continuing effort to build more functional and user-friendly products I am working on an ASP-based vCalendar concept.</p><p>Originally I was working on a training enrollment system where users could enroll/drop for a class, standby in a waiting list and things of that nature. My department has been using this product for sometime now and my boss is starting to realize that more people signup than actually showing up. One of the reason for this she argued was they are forgetting that they had a training. One way to remind them of this training is to exploit Outlook&rsquo;s reminder system.</p><p>In the current stage of the software once a user signs up for a class a plain-text confirmation e-mails gets sent to their mailbox. By adding an attachment of type: .vcs to every outgoing confirmation e-mail I hope to add an appointment to the users&rsquo; calendar. Of course this assumes everyone is using Outlook; although this statement might not be completely true, the percentage here at UCLA is high enough so that we should put an effort to take advantage of it.</p><p>Below is the contents of a typical .vcs file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>BEGIN:VCALENDAR
</span></span><span style=display:flex><span>PRODID:-//Microsoft Corporation//Outlook 9.0 MIMEDIR//EN
</span></span><span style=display:flex><span>VERSION:1.0
</span></span><span style=display:flex><span>BEGIN:VEVENT
</span></span><span style=display:flex><span>DTSTART:20040426T070000Z
</span></span><span style=display:flex><span>DTEND:20040426T073000Z
</span></span><span style=display:flex><span>LOCATION;ENCODING<span style=color:#f92672>=</span>QUOTED-PRINTABLE:Test
</span></span><span style=display:flex><span>TRANSP:1
</span></span><span style=display:flex><span>SUMMARY;ENCODING<span style=color:#f92672>=</span>QUOTED-PRINTABLE:Test
</span></span><span style=display:flex><span>PRIORITY:3
</span></span><span style=display:flex><span>END:VEVENT
</span></span><span style=display:flex><span>END:VCALENDAR 
</span></span></code></pre></div><p>Among other things it contains the title of the event (SUMMARY), it contains the location where the event occurs (LOCATION), the time when the event starts (DTSTART) and ends (DTEND) and finally the priority of the event (PRIORITY). In order for my web-application to send this .vcs attachment I have to dynamically generate this vcs file. Because each users could be signing up for a different class, at different and often times at different locations.</p><p><strong>Problems</strong><br>The e-mail gets sent out using the default CDONTS object that comes with IIS. In order to send an attachment using CDONTS I have to use the .attachment property and point it to a file on the local server. The problem with this is that I cannot simply write to say: &ldquo;appointment.vcs&rdquo; this will cause problems when multiple people signup at the same time and the mail-server was in the process of sending the first mail. In that case two things could happen: (1) the mail-server (in my case Microsoft Exchange) usually locks the file which would cause any additional writes to this file to fail and therefore while the first mail is being delivered no other attachments can be prepared; or (2) the mail-server will not lock the file and allow the system to modify the contents, this could result in a terrible bug where the user would get an e-mail saying they signed up for a say Monday even though they actually wanted to signup for Tuesday. The reason I say this is a terrible bug is because it&rsquo;s not going to happen every time. It will only happen once in a while specially when the mail takes longer to deliver.</p><p>The solution is to write the file in different (unique) file names for each enrollment. This could be acheived by using the EnrollmentId from the database if there is one or some other uniquely identifiable information about the enrollment.</p></div><h2>Comments</h2><script src=https://utteranc.es/client.js repo=splusq/splusq.github.io issue-term=title theme=github-light crossorigin=anonymous async></script></main></body></html>