<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Outlook’s vCalender using ASP | Salman Quazi</title><meta name=keywords content="Uncategorized"><meta name=description content="As part of a continuing effort to build more functional and user-friendly products I am working on an ASP-based vCalendar concept.
Originally I was working on a training enrollment system where users could enroll/drop for a class, standby in a waiting list and things of that nature. My department has been using this product for sometime now and my boss is starting to realize that more people signup than actually showing up."><meta name=author content><link rel=canonical href=https://www.salmanq.com/blog/outlooks-vcalender-using-asp/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.salmanq.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.salmanq.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.salmanq.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.salmanq.com/apple-touch-icon.png><link rel=mask-icon href=https://www.salmanq.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-38742121-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="Outlook’s vCalender using ASP"><meta property="og:description" content="As part of a continuing effort to build more functional and user-friendly products I am working on an ASP-based vCalendar concept.
Originally I was working on a training enrollment system where users could enroll/drop for a class, standby in a waiting list and things of that nature. My department has been using this product for sometime now and my boss is starting to realize that more people signup than actually showing up."><meta property="og:type" content="article"><meta property="og:url" content="https://www.salmanq.com/blog/outlooks-vcalender-using-asp/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2004-12-07T03:47:28+00:00"><meta property="article:modified_time" content="2004-12-07T03:47:28+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Outlook’s vCalender using ASP"><meta name=twitter:description content="As part of a continuing effort to build more functional and user-friendly products I am working on an ASP-based vCalendar concept.
Originally I was working on a training enrollment system where users could enroll/drop for a class, standby in a waiting list and things of that nature. My department has been using this product for sometime now and my boss is starting to realize that more people signup than actually showing up."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://www.salmanq.com/blog/"},{"@type":"ListItem","position":2,"name":"Outlook’s vCalender using ASP","item":"https://www.salmanq.com/blog/outlooks-vcalender-using-asp/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Outlook’s vCalender using ASP","name":"Outlook’s vCalender using ASP","description":"As part of a continuing effort to build more functional and user-friendly products I am working on an ASP-based vCalendar concept.\nOriginally I was working on a training enrollment system where users could enroll/drop for a class, standby in a waiting list and things of that nature. My department has been using this product for sometime now and my boss is starting to realize that more people signup than actually showing up.","keywords":["Uncategorized"],"articleBody":"As part of a continuing effort to build more functional and user-friendly products I am working on an ASP-based vCalendar concept.\nOriginally I was working on a training enrollment system where users could enroll/drop for a class, standby in a waiting list and things of that nature. My department has been using this product for sometime now and my boss is starting to realize that more people signup than actually showing up. One of the reason for this she argued was they are forgetting that they had a training. One way to remind them of this training is to exploit Outlook’s reminder system.\nIn the current stage of the software once a user signs up for a class a plain-text confirmation e-mails gets sent to their mailbox. By adding an attachment of type: .vcs to every outgoing confirmation e-mail I hope to add an appointment to the users’ calendar. Of course this assumes everyone is using Outlook; although this statement might not be completely true, the percentage here at UCLA is high enough so that we should put an effort to take advantage of it.\nBelow is the contents of a typical .vcs file:\nBEGIN:VCALENDAR PRODID:-//Microsoft Corporation//Outlook 9.0 MIMEDIR//EN VERSION:1.0 BEGIN:VEVENT DTSTART:20040426T070000Z DTEND:20040426T073000Z LOCATION;ENCODING=QUOTED-PRINTABLE:Test TRANSP:1 SUMMARY;ENCODING=QUOTED-PRINTABLE:Test PRIORITY:3 END:VEVENT END:VCALENDAR Among other things it contains the title of the event (SUMMARY), it contains the location where the event occurs (LOCATION), the time when the event starts (DTSTART) and ends (DTEND) and finally the priority of the event (PRIORITY). In order for my web-application to send this .vcs attachment I have to dynamically generate this vcs file. Because each users could be signing up for a different class, at different and often times at different locations.\nProblems\nThe e-mail gets sent out using the default CDONTS object that comes with IIS. In order to send an attachment using CDONTS I have to use the .attachment property and point it to a file on the local server. The problem with this is that I cannot simply write to say: “appointment.vcs” this will cause problems when multiple people signup at the same time and the mail-server was in the process of sending the first mail. In that case two things could happen: (1) the mail-server (in my case Microsoft Exchange) usually locks the file which would cause any additional writes to this file to fail and therefore while the first mail is being delivered no other attachments can be prepared; or (2) the mail-server will not lock the file and allow the system to modify the contents, this could result in a terrible bug where the user would get an e-mail saying they signed up for a say Monday even though they actually wanted to signup for Tuesday. The reason I say this is a terrible bug is because it’s not going to happen every time. It will only happen once in a while specially when the mail takes longer to deliver.\nThe solution is to write the file in different (unique) file names for each enrollment. This could be acheived by using the EnrollmentId from the database if there is one or some other uniquely identifiable information about the enrollment.\n","wordCount":"527","inLanguage":"en","datePublished":"2004-12-07T03:47:28Z","dateModified":"2004-12-07T03:47:28Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.salmanq.com/blog/outlooks-vcalender-using-asp/"},"publisher":{"@type":"Organization","name":"Salman Quazi","logo":{"@type":"ImageObject","url":"https://www.salmanq.com/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.salmanq.com/ accesskey=h title="Salman Quazi (Alt + H)">Salman Quazi</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.salmanq.com/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://github.com/splusq/ title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.linkedin.com/in/salmanquazi/ title=LinkedIn><span>LinkedIn</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.twitter.com/splusq title=Twitter><span>Twitter</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><div class=post><h1>Outlook’s vCalender using ASP</h1><time datetime=2004-12-07T03:47:28Z class=post-date>Tue, Dec 7, 2004</time><p>As part of a continuing effort to build more functional and user-friendly products I am working on an ASP-based vCalendar concept.</p><p>Originally I was working on a training enrollment system where users could enroll/drop for a class, standby in a waiting list and things of that nature. My department has been using this product for sometime now and my boss is starting to realize that more people signup than actually showing up. One of the reason for this she argued was they are forgetting that they had a training. One way to remind them of this training is to exploit Outlook&rsquo;s reminder system.</p><p>In the current stage of the software once a user signs up for a class a plain-text confirmation e-mails gets sent to their mailbox. By adding an attachment of type: .vcs to every outgoing confirmation e-mail I hope to add an appointment to the users&rsquo; calendar. Of course this assumes everyone is using Outlook; although this statement might not be completely true, the percentage here at UCLA is high enough so that we should put an effort to take advantage of it.</p><p>Below is the contents of a typical .vcs file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>BEGIN:VCALENDAR
</span></span><span style=display:flex><span>PRODID:-//Microsoft Corporation//Outlook 9.0 MIMEDIR//EN
</span></span><span style=display:flex><span>VERSION:1.0
</span></span><span style=display:flex><span>BEGIN:VEVENT
</span></span><span style=display:flex><span>DTSTART:20040426T070000Z
</span></span><span style=display:flex><span>DTEND:20040426T073000Z
</span></span><span style=display:flex><span>LOCATION;ENCODING<span style=color:#f92672>=</span>QUOTED-PRINTABLE:Test
</span></span><span style=display:flex><span>TRANSP:1
</span></span><span style=display:flex><span>SUMMARY;ENCODING<span style=color:#f92672>=</span>QUOTED-PRINTABLE:Test
</span></span><span style=display:flex><span>PRIORITY:3
</span></span><span style=display:flex><span>END:VEVENT
</span></span><span style=display:flex><span>END:VCALENDAR 
</span></span></code></pre></div><p>Among other things it contains the title of the event (SUMMARY), it contains the location where the event occurs (LOCATION), the time when the event starts (DTSTART) and ends (DTEND) and finally the priority of the event (PRIORITY). In order for my web-application to send this .vcs attachment I have to dynamically generate this vcs file. Because each users could be signing up for a different class, at different and often times at different locations.</p><p><strong>Problems</strong><br>The e-mail gets sent out using the default CDONTS object that comes with IIS. In order to send an attachment using CDONTS I have to use the .attachment property and point it to a file on the local server. The problem with this is that I cannot simply write to say: &ldquo;appointment.vcs&rdquo; this will cause problems when multiple people signup at the same time and the mail-server was in the process of sending the first mail. In that case two things could happen: (1) the mail-server (in my case Microsoft Exchange) usually locks the file which would cause any additional writes to this file to fail and therefore while the first mail is being delivered no other attachments can be prepared; or (2) the mail-server will not lock the file and allow the system to modify the contents, this could result in a terrible bug where the user would get an e-mail saying they signed up for a say Monday even though they actually wanted to signup for Tuesday. The reason I say this is a terrible bug is because it&rsquo;s not going to happen every time. It will only happen once in a while specially when the mail takes longer to deliver.</p><p>The solution is to write the file in different (unique) file names for each enrollment. This could be acheived by using the EnrollmentId from the database if there is one or some other uniquely identifiable information about the enrollment.</p></div><h2>Comments</h2><script src=https://utteranc.es/client.js repo=splusq/splusq.github.io issue-term=title theme=github-dark crossorigin=anonymous async></script></main><footer class=footer><span>&copy; 2023 <a href=https://www.salmanq.com/>Salman Quazi</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>