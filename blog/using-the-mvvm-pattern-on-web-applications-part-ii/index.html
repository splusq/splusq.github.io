<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Using the MVVM pattern on web applications – Part II | Salman Quazi</title><meta name=keywords content="Uncategorized"><meta name=description content="Last time we looked at what the MVVM pattern was, and how it is used today in XAML-based applications. Today we are going to take a step further and build a mechanism to use the MVVM pattern on traditional web applications. Imagine how powerful it would be if your UI could evolve independently. We are going to build a simple web application that will display top 5 &ldquo;memory intensive&rdquo; processes on the server side, and here&rsquo;s our basic architecture: Recall, with MVVM we need the ability for our ViewModels to somehow send messages to the UI."><meta name=author content><link rel=canonical href=https://www.salmanq.com/blog/using-the-mvvm-pattern-on-web-applications-part-ii/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.salmanq.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.salmanq.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.salmanq.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.salmanq.com/apple-touch-icon.png><link rel=mask-icon href=https://www.salmanq.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-38742121-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="Using the MVVM pattern on web applications – Part II"><meta property="og:description" content="Last time we looked at what the MVVM pattern was, and how it is used today in XAML-based applications. Today we are going to take a step further and build a mechanism to use the MVVM pattern on traditional web applications. Imagine how powerful it would be if your UI could evolve independently. We are going to build a simple web application that will display top 5 &ldquo;memory intensive&rdquo; processes on the server side, and here&rsquo;s our basic architecture: Recall, with MVVM we need the ability for our ViewModels to somehow send messages to the UI."><meta property="og:type" content="article"><meta property="og:url" content="https://www.salmanq.com/blog/using-the-mvvm-pattern-on-web-applications-part-ii/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2013-03-03T04:23:51+00:00"><meta property="article:modified_time" content="2013-03-03T04:23:51+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Using the MVVM pattern on web applications – Part II"><meta name=twitter:description content="Last time we looked at what the MVVM pattern was, and how it is used today in XAML-based applications. Today we are going to take a step further and build a mechanism to use the MVVM pattern on traditional web applications. Imagine how powerful it would be if your UI could evolve independently. We are going to build a simple web application that will display top 5 &ldquo;memory intensive&rdquo; processes on the server side, and here&rsquo;s our basic architecture: Recall, with MVVM we need the ability for our ViewModels to somehow send messages to the UI."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://www.salmanq.com/blog/"},{"@type":"ListItem","position":2,"name":"Using the MVVM pattern on web applications – Part II","item":"https://www.salmanq.com/blog/using-the-mvvm-pattern-on-web-applications-part-ii/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Using the MVVM pattern on web applications – Part II","name":"Using the MVVM pattern on web applications – Part II","description":"Last time we looked at what the MVVM pattern was, and how it is used today in XAML-based applications. Today we are going to take a step further and build a mechanism to use the MVVM pattern on traditional web applications. Imagine how powerful it would be if your UI could evolve independently. We are going to build a simple web application that will display top 5 \u0026ldquo;memory intensive\u0026rdquo; processes on the server side, and here\u0026rsquo;s our basic architecture: Recall, with MVVM we need the ability for our ViewModels to somehow send messages to the UI.","keywords":["Uncategorized"],"articleBody":"Last time we looked at what the MVVM pattern was, and how it is used today in XAML-based applications. Today we are going to take a step further and build a mechanism to use the MVVM pattern on traditional web applications. Imagine how powerful it would be if your UI could evolve independently. We are going to build a simple web application that will display top 5 “memory intensive” processes on the server side, and here’s our basic architecture: Recall, with MVVM we need the ability for our ViewModels to somehow send messages to the UI. In XAML that happened through Binding events. However, with web application the client and service are completely out-of-process so we need another mechanism to communicate. We use websocket to send messages to the client on the same transport that initiated the connection to the service in the first place. There are few subtleties, but let’s get started we have a somewhat long road ahead, and we will talk about them along the way. Let’s start with the most basic step, the model of our data.\npublic class ProcessMetadata { public string Name { get; set; } public string Memory { get; set; } public ProcessMetadata(string name, string memory) { this.Name = name; this.Memory = memory; } } Nothing special there - all we care about is the name of the process, and the memory it’s currently consuming. Now, that we have the model we want to build our ViewModel (the core logic).\npublic class TaskViewModel : BaseViewModel { private Timer timer; private int counter; private Process[] runningProcesses; // a list of models (remember in MVVM the ViewModel \"knows\" about the Model) private IList taskList; public IList TaskList { get { return taskList; } set { RaiseAndSetProperty","wordCount":"841","inLanguage":"en","datePublished":"2013-03-03T04:23:51Z","dateModified":"2013-03-03T04:23:51Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.salmanq.com/blog/using-the-mvvm-pattern-on-web-applications-part-ii/"},"publisher":{"@type":"Organization","name":"Salman Quazi","logo":{"@type":"ImageObject","url":"https://www.salmanq.com/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.salmanq.com/ accesskey=h title="Salman Quazi (Alt + H)">Salman Quazi</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.salmanq.com/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://github.com/splusq/ title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.linkedin.com/in/salmanquazi/ title=LinkedIn><span>LinkedIn</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.twitter.com/splusq title=Twitter><span>Twitter</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><div class=post><h1>Using the MVVM pattern on web applications – Part II</h1><time datetime=2013-03-03T04:23:51Z class=post-date>Sun, Mar 3, 2013</time><p><a href=/blog/using-the-mvvm-pattern-on-web-applications-part-i/>Last time we looked at what the MVVM pattern was</a>, and how it is used today in XAML-based applications. Today we are going to take a step further and build a mechanism to use the MVVM pattern on traditional web applications. Imagine how powerful it would be if your UI could evolve independently. We are going to build a simple web application that will display top 5 &ldquo;memory intensive&rdquo; processes on the server side, and here&rsquo;s our basic architecture: <img loading=lazy src=/2013/03/mvvm-web-pattern.png alt="MVVM Architecture for Web Applications"></p><p>Recall, with MVVM we need the ability for our ViewModels to somehow send messages to the UI. In XAML that happened through Binding events. However, with web application the client and service are completely out-of-process so we need another mechanism to communicate. We use websocket to send messages to the client on the same transport that initiated the connection to the service in the first place. There are few subtleties, but let&rsquo;s get started we have a somewhat long road ahead, and we will talk about them along the way. Let&rsquo;s start with the most basic step, the model of our data.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ProcessMetadata</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> Name { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> Memory { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> ProcessMetadata(<span style=color:#66d9ef>string</span> name, <span style=color:#66d9ef>string</span> memory)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.Name = name;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.Memory = memory;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>} 
</span></span></code></pre></div><p>Nothing special there - all we care about is the name of the process, and the memory it&rsquo;s currently consuming. Now, that we have the model we want to build our ViewModel (the core logic).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TaskViewModel</span> : BaseViewModel
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Timer timer;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> counter;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Process[] runningProcesses;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// a list of models (remember in MVVM the ViewModel &#34;knows&#34; about the Model)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> IList&lt;ProcessMetadata&gt; taskList;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> IList&lt;ProcessMetadata&gt; TaskList
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>get</span>
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> taskList;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>set</span>
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            RaiseAndSetProperty&lt;IList&lt;ProcessMetadata&gt;&gt;(<span style=color:#66d9ef>ref</span> taskList, <span style=color:#66d9ef>value</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> TaskViewModel()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        taskList = <span style=color:#66d9ef>new</span> List&lt;ProcessMetadata&gt;();
</span></span><span style=display:flex><span>        timer = <span style=color:#66d9ef>new</span> Timer(updateTasks, <span style=color:#66d9ef>null</span>, <span style=color:#ae81ff>2000</span>, <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> updateTasks(Object state)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        runningProcesses = Process.GetProcesses();
</span></span><span style=display:flex><span>        TaskList = runningProcesses.
</span></span><span style=display:flex><span>            OrderByDescending(p =&gt; p.WorkingSet64).
</span></span><span style=display:flex><span>            ThenBy(p =&gt; p.ProcessName).
</span></span><span style=display:flex><span>            Select(p =&gt; <span style=color:#66d9ef>new</span> ProcessMetadata(
</span></span><span style=display:flex><span>                        p.ProcessName, String.Format(<span style=color:#e6db74>&#34;{0:n0} KB&#34;</span>, (p.WorkingSet64/<span style=color:#ae81ff>1024</span>)))).
</span></span><span style=display:flex><span>            Take(<span style=color:#ae81ff>5</span>).
</span></span><span style=display:flex><span>            ToList();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (++counter &gt;= <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            timer.Change(Timeout.Infinite, Timeout.Infinite);
</span></span><span style=display:flex><span>            timer.Dispose();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>} 
</span></span></code></pre></div><p>The first thing to notice here with the ViewModel here is that there is nothing about the UI. We are dealing with normal variables, not UI elements. So what we are doing here is creating a timer, that runs every 2 seconds, and updates the TaskList property. That&rsquo;s it. In the setter of the TaskList we call a RaisePropertyChanged method. If you <a href=/blog/using-the-mvvm-pattern-on-web-applications-part-i/>recall in Part I</a>, we discussed the INotifyPropertyChanged interface - the standard approach to raising the PropertyChanged event is to implement a RaisePropertyChange method. And that&rsquo;s exactly what we have here. Nothing different from what you would do in a traditional XAML application. But the secret sauce is what the RaisePropertyChanged method does in this specific web application case:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BaseViewModel</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> RaiseAndSetProperty&lt;T&gt;(<span style=color:#66d9ef>ref</span> T field, T <span style=color:#66d9ef>value</span>, [CallerMemberName] <span style=color:#66d9ef>string</span> property = <span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (!field.Equals(<span style=color:#66d9ef>value</span>))
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            field = <span style=color:#66d9ef>value</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// At this point we need to do something special - since we are not in the XAML world</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> json;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>typeof</span>(T).IsValueType)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                json = <span style=color:#66d9ef>new</span> JObject() { <span style=color:#66d9ef>new</span> JProperty(property, <span style=color:#66d9ef>value</span>) }.ToString();
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                json = JObject.FromObject(<span style=color:#66d9ef>new</span> { Node = <span style=color:#66d9ef>value</span> }).ToString();
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// A simple websocket session manager that allows communication back to the client</span>
</span></span><span style=display:flex><span>            SessionManager.Current.SendToClient(json);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>} 
</span></span></code></pre></div><p>Okay the trick here is the JSON serialization and send back to the client via the Websocket. Quite simple really. We are also using the .NET 4.5 new CallerMemberName feature which automatically populates a parameter with the name of the member name that&rsquo;s calling this method - very useful in this case. So we are almost there. But we have one more missing piece on the server side. <a href=/blog/using-the-mvvm-pattern-on-web-applications-part-i/>Recall</a> in our last discussion we talked about a DataContext. The View creates the ViewModel and sets it as part of the DataContext. But in this case the view is a HTML - how can it create an instance of the ViewModel - which is on the server side? So we need to provide a really simple mechanism for this, and that&rsquo;s done via-exposing a MVC 4 Web API - REST endpoint:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AttachController</span> : ApiController
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> Get(<span style=color:#66d9ef>string</span> id)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        Activator.CreateInstance(Type.GetType(id));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>} 
</span></span></code></pre></div><p>That&rsquo;s it - all we are doing here is exposing a /attach/ API - where you can pass in the name of the ViewModel and it will use reflection to create an instance of that type for you on the server side. That&rsquo;s all. When the instance is created the rest of the communication happens through WebSockets like we saw earlier. We are very close to unwrapping this gift and this whole thing working end-to-end, but for that we will need the UI - which is a simple HTML page. We will discuss this in part III of our discussion.</p><ul><li><a href=/blog/using-the-mvvm-pattern-on-web-applications-part-i/>Using the MVVM pattern on web applications – Part I</a></li><li>Using the MVVM pattern on web applications – Part II</li><li><a href=/blog/using-the-mvvm-pattern-on-web-applications-part-iii/>Using the MVVM pattern on web applications – Part III</a></li></ul></div><h2>Comments</h2><script src=https://utteranc.es/client.js repo=splusq/splusq.github.io issue-term=title theme=github-dark crossorigin=anonymous async></script></main><footer class=footer><span>&copy; 2023 <a href=https://www.salmanq.com/>Salman Quazi</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>