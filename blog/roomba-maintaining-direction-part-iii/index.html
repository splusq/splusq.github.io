<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=generator content="Hugo 0.134.2"><meta name=viewport content="width=device-width,initial-scale=1"><title>Roomba: Maintaining Direction Part III &#183; Salman Quazi</title>
<meta name=description content><link type=text/css rel=stylesheet href=https://www.salmanq.com/css/print.css media=print><link type=text/css rel=stylesheet href=https://www.salmanq.com/css/poole.css><link type=text/css rel=stylesheet href=https://www.salmanq.com/css/syntax.css><link type=text/css rel=stylesheet href=https://www.salmanq.com/css/hyde.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700"><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png><style type=text/css>.sidebar-about h1{font-size:1.95rem;font-weight:400}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-K4WVH5P91F"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-K4WVH5P91F")</script></head><body class=theme-base-08><aside class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://www.salmanq.com/><h1>Salman Quazi</h1></a><p class=lead>Director of Engineering for Microsoft Azure OpenAI in Mountain View, CA.</p></div><nav><ul class=sidebar-nav><li><a href=https://www.salmanq.com/>Home</a></li><li><a href=/blog/>Blog</a></li><li><a href=https://github.com/splusq/>Github</a></li><li><a href=https://www.linkedin.com/in/salmanquazi/>LinkedIn</a></li><li><a href=https://www.twitter.com/splusq>Twitter</a></li></ul></nav><p>Opinions are my own.</p></div></aside><main class="content container"><div class=post><h1>Roomba: Maintaining Direction Part III</h1><time datetime=2004-12-11T00:56:27Z class=post-date>Sat, Dec 11, 2004</time><p>So far I have discussed the following topics:</p><ol><li><a href=/blog/vacuum-cleaner/>Introduction to our intelligent Roomba Vacuum cleaner.</a></li><li><a href=/blog/torus-smart-array-part-ii/>How a torus (smart array) is used to maintain the state of the cleaning surface.</a></li></ol><p>Today I will discuss how we managed to maintain the direction we are traveling in.</p><p>What we did was to connect two light sensors on both sides of the robot. Then we attached a pinwheel (printed on a paper; see diagram below) attached to the motor using gears, right in front of the sensor. As the motor moved the pinwheel moved and at the same time we could use the sensors to see how many blacks we have seen on the LEFT motor and how many blacks we have seen on the RIGHT motor. A typical straight line direction will see same number of both black and white stripes (because you expect both the left and the right motor to move the same amount of distance causing the same number of black/white alternations); whereas a typical turn (90 degrees) will see more black on one motor compared to the other (once again because during a turn one of the motors is turned off and the other is run at full speed in order to make the turn happen).</p><p><img src=/2004/10/pinwheel.jpg alt="Pinwheel used to maintain direction"></p><p>Internally the system was designed to run using two threads. One that constantly monitors what the reading from the LEFT sensor and compared this value to the reading from the RIGHT sensor. If the system is meant to go straight and we are getting different values from the LEFT or the RIGHT sensors then they would be adjusted (by temporarily shuting down the motor with higher values) until both again have the same value (+/- some intrinsic error).</p><p>This way we were able to maintain direction either going straight or even making 90 degree turns. Next time I will present actual C code and discuss the details of the code and why we choose a simple two threaded model.</p></div><h2>Comments</h2><script src=https://utteranc.es/client.js repo=splusq/splusq.github.io issue-term=title theme=github-light crossorigin=anonymous async></script></main></body></html>