<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Solution to Line Tracker | Salman Quazi</title><meta name=keywords content="Uncategorized"><meta name=description content="In my previous post I discussed an algorithm that it is much better than the general line following algorithm that one might think of at first. Last night I implemented the algorithm with NQC with descent results. Here&rsquo;s the solution:
/*********************************************** * Salman Quazi * CS-595EA * Date: September 19, 2004 ***********************************************/ /* Constant Definitions */ #define SENSOR	SENSOR_1 #define LEFT_MOTOR	OUT_C #define RIGHT_MOTOR	OUT_A /* Speed settings */ #define NORMAL_SPEED 7 #define TURN_SPEED 2 #define DELAY	20 /* This setting depends on several conditions like: lighting, contrast between the tape and the floor ."><meta name=author content><link rel=canonical href=https://www.salmanq.com/blog/solution-to-line-tracker/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.salmanq.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.salmanq.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.salmanq.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.salmanq.com/apple-touch-icon.png><link rel=mask-icon href=https://www.salmanq.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-38742121-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="Solution to Line Tracker"><meta property="og:description" content="In my previous post I discussed an algorithm that it is much better than the general line following algorithm that one might think of at first. Last night I implemented the algorithm with NQC with descent results. Here&rsquo;s the solution:
/*********************************************** * Salman Quazi * CS-595EA * Date: September 19, 2004 ***********************************************/ /* Constant Definitions */ #define SENSOR	SENSOR_1 #define LEFT_MOTOR	OUT_C #define RIGHT_MOTOR	OUT_A /* Speed settings */ #define NORMAL_SPEED 7 #define TURN_SPEED 2 #define DELAY	20 /* This setting depends on several conditions like: lighting, contrast between the tape and the floor ."><meta property="og:type" content="article"><meta property="og:url" content="https://www.salmanq.com/blog/solution-to-line-tracker/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2004-10-02T01:17:34+00:00"><meta property="article:modified_time" content="2004-10-02T01:17:34+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Solution to Line Tracker"><meta name=twitter:description content="In my previous post I discussed an algorithm that it is much better than the general line following algorithm that one might think of at first. Last night I implemented the algorithm with NQC with descent results. Here&rsquo;s the solution:
/*********************************************** * Salman Quazi * CS-595EA * Date: September 19, 2004 ***********************************************/ /* Constant Definitions */ #define SENSOR	SENSOR_1 #define LEFT_MOTOR	OUT_C #define RIGHT_MOTOR	OUT_A /* Speed settings */ #define NORMAL_SPEED 7 #define TURN_SPEED 2 #define DELAY	20 /* This setting depends on several conditions like: lighting, contrast between the tape and the floor ."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://www.salmanq.com/blog/"},{"@type":"ListItem","position":2,"name":"Solution to Line Tracker","item":"https://www.salmanq.com/blog/solution-to-line-tracker/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Solution to Line Tracker","name":"Solution to Line Tracker","description":"In my previous post I discussed an algorithm that it is much better than the general line following algorithm that one might think of at first. Last night I implemented the algorithm with NQC with descent results. Here\u0026rsquo;s the solution:\n/*********************************************** * Salman Quazi * CS-595EA * Date: September 19, 2004 ***********************************************/ /* Constant Definitions */ #define SENSOR\tSENSOR_1 #define LEFT_MOTOR\tOUT_C #define RIGHT_MOTOR\tOUT_A /* Speed settings */ #define NORMAL_SPEED 7 #define TURN_SPEED 2 #define DELAY\t20 /* This setting depends on several conditions like: lighting, contrast between the tape and the floor .","keywords":["Uncategorized"],"articleBody":"In my previous post I discussed an algorithm that it is much better than the general line following algorithm that one might think of at first. Last night I implemented the algorithm with NQC with descent results. Here’s the solution:\n/*********************************************** * Salman Quazi * CS-595EA * Date: September 19, 2004 ***********************************************/ /* Constant Definitions */ #define SENSOR\tSENSOR_1 #define LEFT_MOTOR\tOUT_C #define RIGHT_MOTOR\tOUT_A /* Speed settings */ #define NORMAL_SPEED 7 #define TURN_SPEED 2 #define DELAY\t20 /* This setting depends on several conditions like: lighting, contrast between the tape and the floor ... */ #define LINE_COLOR 768 #define FLOOR_COLOR 710 int eye; /* I have been thinking about taking the average color of the floor and the black tape for more reliable results */ int average_color = (LINE_COLOR+FLOOR_COLOR)/2; task main() { SetPower(LEFT_MOTOR, NORMAL_SPEED); SetPower(RIGHT_MOTOR, NORMAL_SPEED); OnFwd(LEFT_MOTOR+RIGHT_MOTOR); while(true) { eye = SENSOR; SelectDisplay(DISPLAY_SENSOR_1); if (eye \u003c= FLOOR_COLOR) { SetPower(LEFT_MOTOR+RIGHT_MOTOR, TURN_SPEED); Fwd(RIGHT_MOTOR); Rev(LEFT_MOTOR); On(LEFT_MOTOR+RIGHT_MOTOR); while(SENSOR \u003c= FLOOR_COLOR); } else if (eye \u003e= LINE_COLOR) { SetPower(LEFT_MOTOR+RIGHT_MOTOR, TURN_SPEED); Fwd(LEFT_MOTOR); Rev(RIGHT_MOTOR); On(LEFT_MOTOR+RIGHT_MOTOR); while(SENSOR \u003e= LINE_COLOR); } else continue; SetPower(LEFT_MOTOR+RIGHT_MOTOR, NORMAL_SPEED); Fwd(LEFT_MOTOR); Fwd(RIGHT_MOTOR); On(LEFT_MOTOR+RIGHT_MOTOR); } } This was compiled with NQC version 2.5 r3 on RCX 2.0 (on a Windows 2000 Professional system).\nOf course there is room for improvement. (1) Increase NORMAL_SPEED and still be able to follow the line (by reducing latency speed). (2) If the system encounters an object while travelling the line then it should get around it somehow, and so on…\n","wordCount":"242","inLanguage":"en","datePublished":"2004-10-02T01:17:34Z","dateModified":"2004-10-02T01:17:34Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.salmanq.com/blog/solution-to-line-tracker/"},"publisher":{"@type":"Organization","name":"Salman Quazi","logo":{"@type":"ImageObject","url":"https://www.salmanq.com/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.salmanq.com/ accesskey=h title="Salman Quazi (Alt + H)">Salman Quazi</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.salmanq.com/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://github.com/splusq/ title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.linkedin.com/in/salmanquazi/ title=LinkedIn><span>LinkedIn</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.twitter.com/splusq title=Twitter><span>Twitter</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><div class=post><h1>Solution to Line Tracker</h1><time datetime=2004-10-02T01:17:34Z class=post-date>Sat, Oct 2, 2004</time><p>In my <a href=/blog/line-tracker/>previous post</a> I discussed an algorithm that it is much better than the <em>general</em> line following algorithm that one might think of at first. Last night I implemented the algorithm with NQC with descent results. Here&rsquo;s the solution:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>/***********************************************
</span></span></span><span style=display:flex><span><span style=color:#75715e>	* Salman Quazi
</span></span></span><span style=display:flex><span><span style=color:#75715e>	* CS-595EA
</span></span></span><span style=display:flex><span><span style=color:#75715e>	* Date: September 19, 2004
</span></span></span><span style=display:flex><span><span style=color:#75715e>***********************************************/</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/* Constant Definitions */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define SENSOR		SENSOR_1
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define LEFT_MOTOR	OUT_C
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define RIGHT_MOTOR	OUT_A
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/* Speed settings */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define NORMAL_SPEED 7
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define TURN_SPEED 2
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define DELAY	20
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/* This setting depends on several conditions like: lighting, contrast between the tape and the floor ... */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define LINE_COLOR 768
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define FLOOR_COLOR 710
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> eye;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/* I have been thinking about taking the average color of the 
</span></span></span><span style=display:flex><span><span style=color:#75715e>floor and the black tape for more reliable results */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> average_color <span style=color:#f92672>=</span> (LINE_COLOR<span style=color:#f92672>+</span>FLOOR_COLOR)<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>task <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>SetPower</span>(LEFT_MOTOR,  NORMAL_SPEED);
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>SetPower</span>(RIGHT_MOTOR, NORMAL_SPEED);
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>OnFwd</span>(LEFT_MOTOR<span style=color:#f92672>+</span>RIGHT_MOTOR);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>while</span>(true) {
</span></span><span style=display:flex><span>		eye <span style=color:#f92672>=</span> SENSOR;
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>SelectDisplay</span>(DISPLAY_SENSOR_1);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> (eye <span style=color:#f92672>&lt;=</span> FLOOR_COLOR) {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>SetPower</span>(LEFT_MOTOR<span style=color:#f92672>+</span>RIGHT_MOTOR, TURN_SPEED);
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>Fwd</span>(RIGHT_MOTOR);
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>Rev</span>(LEFT_MOTOR);
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>On</span>(LEFT_MOTOR<span style=color:#f92672>+</span>RIGHT_MOTOR);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>while</span>(SENSOR <span style=color:#f92672>&lt;=</span> FLOOR_COLOR);
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (eye <span style=color:#f92672>&gt;=</span> LINE_COLOR) {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>SetPower</span>(LEFT_MOTOR<span style=color:#f92672>+</span>RIGHT_MOTOR, TURN_SPEED);
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>Fwd</span>(LEFT_MOTOR);
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>Rev</span>(RIGHT_MOTOR);
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>On</span>(LEFT_MOTOR<span style=color:#f92672>+</span>RIGHT_MOTOR);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>while</span>(SENSOR <span style=color:#f92672>&gt;=</span> LINE_COLOR);
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>SetPower</span>(LEFT_MOTOR<span style=color:#f92672>+</span>RIGHT_MOTOR, NORMAL_SPEED);
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Fwd</span>(LEFT_MOTOR);
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Fwd</span>(RIGHT_MOTOR);
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>On</span>(LEFT_MOTOR<span style=color:#f92672>+</span>RIGHT_MOTOR);
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>} 
</span></span></code></pre></div><p>This was compiled with <a href=http://bricxcc.sourceforge.net/nqc/release/index.html>NQC version 2.5 r3</a> on <a href=http://mindstorms.lego.com/support/en/ris20.asp>RCX 2.0</a> (on a Windows 2000 Professional system).</p><p>Of course there is room for improvement. (1) Increase NORMAL_SPEED and still be able to follow the line (by reducing latency speed). (2) If the system encounters an object while travelling the line then it should get around it somehow, and so on&mldr;</p></div><h2>Comments</h2><script src=https://utteranc.es/client.js repo=splusq/splusq.github.io issue-term=title theme=github-dark crossorigin=anonymous async></script></main><footer class=footer><span>&copy; 2023 <a href=https://www.salmanq.com/>Salman Quazi</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>