<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Script Task reading/returning data | Salman Quazi</title>
<meta name=keywords content="Uncategorized"><meta name=description content="When you are using the Script Task in SSIS it&rsquo;s often useful to have the script task return data, and also at times useful to have access to external data. Once you drop a Script Task onto the designer and go to it&rsquo;s editor, under the script tab you&rsquo;ll find two attributes: ReadOnlyVariables, ReadWriteVariables. The first allows the script to access external user variables for reading, while the latter allows write access."><meta name=author content><link rel=canonical href=https://www.salmanq.com/blog/script-task-readingreturning-data/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://www.salmanq.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.salmanq.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.salmanq.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.salmanq.com/apple-touch-icon.png><link rel=mask-icon href=https://www.salmanq.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-38742121-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="Script Task reading/returning data"><meta property="og:description" content="When you are using the Script Task in SSIS it&rsquo;s often useful to have the script task return data, and also at times useful to have access to external data. Once you drop a Script Task onto the designer and go to it&rsquo;s editor, under the script tab you&rsquo;ll find two attributes: ReadOnlyVariables, ReadWriteVariables. The first allows the script to access external user variables for reading, while the latter allows write access."><meta property="og:type" content="article"><meta property="og:url" content="https://www.salmanq.com/blog/script-task-readingreturning-data/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2007-05-25T23:58:45+00:00"><meta property="article:modified_time" content="2007-05-25T23:58:45+00:00"><meta property="og:site_name" content="Salman Quazi"><meta name=twitter:card content="summary"><meta name=twitter:title content="Script Task reading/returning data"><meta name=twitter:description content="When you are using the Script Task in SSIS it&rsquo;s often useful to have the script task return data, and also at times useful to have access to external data. Once you drop a Script Task onto the designer and go to it&rsquo;s editor, under the script tab you&rsquo;ll find two attributes: ReadOnlyVariables, ReadWriteVariables. The first allows the script to access external user variables for reading, while the latter allows write access."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://www.salmanq.com/blog/"},{"@type":"ListItem","position":2,"name":"Script Task reading/returning data","item":"https://www.salmanq.com/blog/script-task-readingreturning-data/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Script Task reading/returning data","name":"Script Task reading\/returning data","description":"When you are using the Script Task in SSIS it\u0026rsquo;s often useful to have the script task return data, and also at times useful to have access to external data. Once you drop a Script Task onto the designer and go to it\u0026rsquo;s editor, under the script tab you\u0026rsquo;ll find two attributes: ReadOnlyVariables, ReadWriteVariables. The first allows the script to access external user variables for reading, while the latter allows write access.","keywords":["Uncategorized"],"articleBody":"When you are using the Script Task in SSIS it’s often useful to have the script task return data, and also at times useful to have access to external data. Once you drop a Script Task onto the designer and go to it’s editor, under the script tab you’ll find two attributes: ReadOnlyVariables, ReadWriteVariables. The first allows the script to access external user variables for reading, while the latter allows write access. It’s important to realize that we are talking about user variables which is usually under the User:: namespace. So every variable you list must be prefixed by: User::. If you don’t the script assumes System::. So here’s a screen shot of what a script task might look like: Once you click on the design script you get an editor where you are allowed to type VB.NET code. At this point SSIS script tasks do not support C#. Here’s a sample of how you can access a user variable and set a value to it. As you can see from the sample code below, SSIS variables are not typed:\nPublic Class ScriptMain Public Sub Main()\tDim Var As Variable = Dts.Variables(\"User::DataFiles\") Var.Value = Table Dts.TaskResult = Dts.Results.Success ... end Sub end Class Variables are read the same way:\nDts.Variables(\"User::LoadedFiles\").Value If you find yourself using the script task often then you might consider other ways of transforming and manipulating your data, as they can get extremely difficult to debug.\n","wordCount":"239","inLanguage":"en","datePublished":"2007-05-25T23:58:45Z","dateModified":"2007-05-25T23:58:45Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.salmanq.com/blog/script-task-readingreturning-data/"},"publisher":{"@type":"Organization","name":"Salman Quazi","logo":{"@type":"ImageObject","url":"https://www.salmanq.com/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.salmanq.com/ accesskey=h title="Salman Quazi (Alt + H)">Salman Quazi</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.salmanq.com/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://github.com/splusq/ title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.linkedin.com/in/salmanquazi/ title=LinkedIn><span>LinkedIn</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.twitter.com/splusq title=Twitter><span>Twitter</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Script Task reading/returning data</h1><div class=post-meta>&lt;span title='2007-05-25 23:58:45 +0000 UTC'>May 25, 2007&lt;/span>&amp;nbsp;·&amp;nbsp;2 min</div></header><div class=post-content><p>When you are using the Script Task in SSIS it&rsquo;s often useful to have the script task return data, and also at times useful to have access to external data. Once you drop a Script Task onto the designer and go to it&rsquo;s editor, under the script tab you&rsquo;ll find two attributes: ReadOnlyVariables, ReadWriteVariables. The first allows the script to access external <strong>user variables</strong> for reading, while the latter allows write access. It&rsquo;s important to realize that we are talking about user variables which is usually under the <em>User::</em> namespace. So every variable you list must be prefixed by: User::. If you don&rsquo;t the script assumes System::. So here&rsquo;s a screen shot of what a script task might look like: <a href=/2007/05/script-task1.jpg title="Script Task (Variables)"><img loading=lazy src=/2007/05/script-task1.thumbnail.jpg alt="Script Task (Variables)">
</a>Once you click on the design script you get an editor where you are allowed to type VB.NET code. At this point SSIS script tasks do not support C#. Here&rsquo;s a sample of how you can access a user variable and set a value to it. As you can see from the sample code below, SSIS variables are not typed:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-basic data-lang=basic><span style=display:flex><span> Public Class ScriptMain
</span></span><span style=display:flex><span>	Public Sub Main()	
</span></span><span style=display:flex><span>		Dim Var As Variable <span style=color:#f92672>=</span> Dts<span style=color:#f92672>.</span>Variables(<span style=color:#e6db74>&#34;User::DataFiles&#34;</span>)
</span></span><span style=display:flex><span>		Var<span style=color:#f92672>.</span>Value <span style=color:#f92672>=</span> Table
</span></span><span style=display:flex><span>		Dts<span style=color:#f92672>.</span>TaskResult <span style=color:#f92672>=</span> Dts<span style=color:#f92672>.</span>Results<span style=color:#f92672>.</span>Success
</span></span><span style=display:flex><span>		<span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>	end Sub
</span></span><span style=display:flex><span>end Class 
</span></span></code></pre></div><p>Variables are read the same way:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-basic data-lang=basic><span style=display:flex><span> Dts<span style=color:#f92672>.</span>Variables(<span style=color:#e6db74>&#34;User::LoadedFiles&#34;</span>)<span style=color:#f92672>.</span>Value 
</span></span></code></pre></div><p>If you find yourself using the script task often then you might consider other ways of transforming and manipulating your data, as they can get extremely difficult to debug.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.salmanq.com/tags/uncategorized/>Uncategorized</a></li></ul><nav class=paginav><a class=prev href=https://www.salmanq.com/blog/using-ssis-to-access-network-resources/><span class=title>« Prev</span><br><span>Using SSIS to Access Network Resources</span>
</a><a class=next href=https://www.salmanq.com/blog/reverse-a-linked-list-recursively/><span class=title>Next »</span><br><span>Reverse a linked list recursively</span></a></nav></footer><script src=https://utteranc.es/client.js repo=splusq/splusq.github.io issue-term=title theme=github-dark crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2023 <a href=https://www.salmanq.com/>Salman Quazi</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>