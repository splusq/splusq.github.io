<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Using the MVVM pattern on web applications – Part III | Salman Quazi</title><meta name=keywords content="Uncategorized"><meta name=description content="We are at the finale of this three part series. In part I we discussed the MVVM design pattern, in part II we looked at the overall architecture and how the server side fits into the picture. In this article we are going to look at the client side of this and close with some final thoughts. The best place to start with the client is the HTML - so here&rsquo;s the part of the HTML that&rsquo;s interesting:"><meta name=author content><link rel=canonical href=https://www.salmanq.com/blog/using-the-mvvm-pattern-on-web-applications-part-iii/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.salmanq.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.salmanq.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.salmanq.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.salmanq.com/apple-touch-icon.png><link rel=mask-icon href=https://www.salmanq.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-38742121-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="Using the MVVM pattern on web applications – Part III"><meta property="og:description" content="We are at the finale of this three part series. In part I we discussed the MVVM design pattern, in part II we looked at the overall architecture and how the server side fits into the picture. In this article we are going to look at the client side of this and close with some final thoughts. The best place to start with the client is the HTML - so here&rsquo;s the part of the HTML that&rsquo;s interesting:"><meta property="og:type" content="article"><meta property="og:url" content="https://www.salmanq.com/blog/using-the-mvvm-pattern-on-web-applications-part-iii/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2013-03-06T06:39:59+00:00"><meta property="article:modified_time" content="2013-03-06T06:39:59+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Using the MVVM pattern on web applications – Part III"><meta name=twitter:description content="We are at the finale of this three part series. In part I we discussed the MVVM design pattern, in part II we looked at the overall architecture and how the server side fits into the picture. In this article we are going to look at the client side of this and close with some final thoughts. The best place to start with the client is the HTML - so here&rsquo;s the part of the HTML that&rsquo;s interesting:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://www.salmanq.com/blog/"},{"@type":"ListItem","position":2,"name":"Using the MVVM pattern on web applications – Part III","item":"https://www.salmanq.com/blog/using-the-mvvm-pattern-on-web-applications-part-iii/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Using the MVVM pattern on web applications – Part III","name":"Using the MVVM pattern on web applications – Part III","description":"We are at the finale of this three part series. In part I we discussed the MVVM design pattern, in part II we looked at the overall architecture and how the server side fits into the picture. In this article we are going to look at the client side of this and close with some final thoughts. The best place to start with the client is the HTML - so here\u0026rsquo;s the part of the HTML that\u0026rsquo;s interesting:","keywords":["Uncategorized"],"articleBody":"We are at the finale of this three part series. In part I we discussed the MVVM design pattern, in part II we looked at the overall architecture and how the server side fits into the picture. In this article we are going to look at the client side of this and close with some final thoughts. The best place to start with the client is the HTML - so here’s the part of the HTML that’s interesting:\n\u003ctbody data-bind=\"foreach: Node\"\u003e \u003ctr\u003e \u003ctd data-bind=\"text: Name\"\u003e\u003c/td\u003e \u003ctd style=\"text-align:right;font-weight:bold;\" data-bind=\"text: Memory\"\u003e\u003c/td\u003e \u003c/tr\u003e \u003c/tbody\u003e Notice that we are able to use a “data binding” like syntax similar to what we have seen in XAML using Knockout. Basically we are binding a list of “node” elements as a row, and for-each row we want to bind the Name and Memory properties. What’s really great about this is that the names of the properties came directly from the server model. But how do we light this up? Meaning, how do we attach this page to the server side ViewModel? We do that using:\n$(document).ready(function () { new dataContext(\"Service.ViewModels.TaskViewModel\"); }); Recall in part II, we exposed a MVC Web API to create the ViewModel - which accepted the name of the ViewModel we wanted to create. So in JavaScript we created a dataContext object that talks to this API endpoint and hooks the websocket communication. That’s all. Let’s take a look at that too now:\nvar dataContext = function (vm) { var self = this; var init = false; $.getJSON(\"/Service/Api/Attach/\" + vm, function () { connectSocketServer(function (e) { self.update(e.data); }) }); this.update = function (d) { if (!init) { ko.mapping.fromJSON(d, {}, self); ko.applyBindings(self); init = true; } ko.mapping.fromJSON(d, {}, self); } }; There you have it. Notice the getJSON call to have the server create the ViewModel for us, once that happens we use the websocket to communicate to the client and Knockout to apply the Binding. I hope you enjoyed this series and learned a few things. You can download the full working source code - you’re welcome to modify this and use it as you see fit. One thing I do want to mention though - this was written pre .NET 4.5, when Websocket was not part of the .NET BCL - so this source code uses SuperWebsocket. However, now that there is native support for Websocket the code should be refactored.\nUsing the MVVM pattern on web applications – Part I Using the MVVM pattern on web applications – Part II Using the MVVM pattern on web applications – Part III ","wordCount":"428","inLanguage":"en","datePublished":"2013-03-06T06:39:59Z","dateModified":"2013-03-06T06:39:59Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.salmanq.com/blog/using-the-mvvm-pattern-on-web-applications-part-iii/"},"publisher":{"@type":"Organization","name":"Salman Quazi","logo":{"@type":"ImageObject","url":"https://www.salmanq.com/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.salmanq.com/ accesskey=h title="Salman Quazi (Alt + H)">Salman Quazi</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.salmanq.com/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://github.com/splusq/ title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.linkedin.com/in/salmanquazi/ title=LinkedIn><span>LinkedIn</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.twitter.com/splusq title=Twitter><span>Twitter</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><div class=post><h1>Using the MVVM pattern on web applications – Part III</h1><time datetime=2013-03-06T06:39:59Z class=post-date>Wed, Mar 6, 2013</time><p>We are at the finale of this three part series. <a href=/blog/using-the-mvvm-pattern-on-web-applications-part-i/>In part I</a> we discussed the MVVM design pattern, <a href=/blog/using-the-mvvm-pattern-on-web-applications-part-ii/>in part II</a> we looked at the overall architecture and how the server side fits into the picture. In this article we are going to look at the client side of this and close with some final thoughts. The best place to start with the client is the HTML - so here&rsquo;s the part of the HTML that&rsquo;s interesting:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>tbody</span> <span style=color:#a6e22e>data-bind</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;foreach: Node&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>tr</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>td</span> <span style=color:#a6e22e>data-bind</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text: Name&#34;</span>&gt;&lt;/<span style=color:#f92672>td</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>td</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text-align:right;font-weight:bold;&#34;</span> <span style=color:#a6e22e>data-bind</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text: Memory&#34;</span>&gt;&lt;/<span style=color:#f92672>td</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>tr</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>tbody</span>&gt; 
</span></span></code></pre></div><p>Notice that we are able to use a &ldquo;data binding&rdquo; like syntax similar to what we have seen in XAML using <a href=http://knockoutjs.com/>Knockout</a>. Basically we are binding a list of &ldquo;node&rdquo; elements as a row, and for-each row we want to bind the Name and Memory properties. What&rsquo;s really great about this is that the names of the properties came directly <a href=/blog/using-the-mvvm-pattern-on-web-applications-part-ii/>from the server model</a>. But how do we light this up? Meaning, how do we attach this page to the server side ViewModel? We do that using:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>$</span>(document).<span style=color:#a6e22e>ready</span>(<span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>dataContext</span>(<span style=color:#e6db74>&#34;Service.ViewModels.TaskViewModel&#34;</span>);
</span></span><span style=display:flex><span>}); 
</span></span></code></pre></div><p>Recall in part II, <a href=/blog/using-the-mvvm-pattern-on-web-applications-part-ii/>we exposed a MVC Web API to create the ViewModel</a> - which accepted the name of the ViewModel we wanted to create. So in JavaScript we created a dataContext object that talks to this API endpoint and hooks the websocket communication. That&rsquo;s all. Let&rsquo;s take a look at that too now:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span> <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>dataContext</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>vm</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>self</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>init</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>       
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>$</span>.<span style=color:#a6e22e>getJSON</span>(<span style=color:#e6db74>&#34;/Service/Api/Attach/&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>vm</span>, <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>connectSocketServer</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>e</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>self</span>.<span style=color:#a6e22e>update</span>(<span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>data</span>);
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>update</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>d</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>init</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>ko</span>.<span style=color:#a6e22e>mapping</span>.<span style=color:#a6e22e>fromJSON</span>(<span style=color:#a6e22e>d</span>, {}, <span style=color:#a6e22e>self</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>ko</span>.<span style=color:#a6e22e>applyBindings</span>(<span style=color:#a6e22e>self</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>init</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ko</span>.<span style=color:#a6e22e>mapping</span>.<span style=color:#a6e22e>fromJSON</span>(<span style=color:#a6e22e>d</span>, {}, <span style=color:#a6e22e>self</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}; 
</span></span></code></pre></div><p>There you have it. Notice the getJSON call to have the server create the ViewModel for us, once that happens we use the websocket to communicate to the client and Knockout to apply the Binding. I hope you enjoyed this series and learned a few things. You can <a href=/2013/03/HtmlMagic.zip>download the full working source code</a> - you&rsquo;re welcome to modify this and use it as you see fit. One thing I do want to mention though - this was written pre .NET 4.5, when Websocket was not part of the .NET BCL - so this source code uses <a href=http://superwebsocket.codeplex.com/>SuperWebsocket</a>. However, now that there is native support for Websocket the code should be refactored.</p><ul><li><a href=/blog/using-the-mvvm-pattern-on-web-applications-part-i/>Using the MVVM pattern on web applications – Part I</a></li><li><a href=/blog/using-the-mvvm-pattern-on-web-applications-part-ii/>Using the MVVM pattern on web applications – Part II</a></li><li>Using the MVVM pattern on web applications – Part III</li></ul></div><h2>Comments</h2><script src=https://utteranc.es/client.js repo=splusq/splusq.github.io issue-term=title theme=github-dark crossorigin=anonymous async></script></main><footer class=footer><span>&copy; 2023 <a href=https://www.salmanq.com/>Salman Quazi</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>