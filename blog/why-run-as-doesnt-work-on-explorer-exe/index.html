<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Why run as doesn’t work on explorer.exe? | Salman Quazi</title><meta name=keywords content="Uncategorized"><meta name=description content="You will notice in windows no matter how you want to &ldquo;Run as&rdquo; explorer.exe it will not work. Almost all programs you can right-click or hold CTRL and right click to get the run as option but with explorer this doesn&rsquo;t seem work. You cannot even use the command line tool runas /u:administrator to run explorer.
Explorer.exe is a special task. It actually runs all the time and is responsible for the taskbar and other features on the Windows desktop, press CTRL+ALT+DEL right now and you will see explorer."><meta name=author content="Me"><link rel=canonical href=https://www.salmanq.com/blog/why-run-as-doesnt-work-on-explorer-exe/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.salmanq.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.salmanq.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.salmanq.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.salmanq.com/apple-touch-icon.png><link rel=mask-icon href=https://www.salmanq.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-38742121-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="Why run as doesn’t work on explorer.exe?"><meta property="og:description" content="You will notice in windows no matter how you want to &ldquo;Run as&rdquo; explorer.exe it will not work. Almost all programs you can right-click or hold CTRL and right click to get the run as option but with explorer this doesn&rsquo;t seem work. You cannot even use the command line tool runas /u:administrator to run explorer.
Explorer.exe is a special task. It actually runs all the time and is responsible for the taskbar and other features on the Windows desktop, press CTRL+ALT+DEL right now and you will see explorer."><meta property="og:type" content="article"><meta property="og:url" content="https://www.salmanq.com/blog/why-run-as-doesnt-work-on-explorer-exe/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2005-02-23T20:54:39+00:00"><meta property="article:modified_time" content="2005-02-23T20:54:39+00:00"><meta property="og:site_name" content="Salman Quazi"><meta name=twitter:card content="summary"><meta name=twitter:title content="Why run as doesn’t work on explorer.exe?"><meta name=twitter:description content="You will notice in windows no matter how you want to &ldquo;Run as&rdquo; explorer.exe it will not work. Almost all programs you can right-click or hold CTRL and right click to get the run as option but with explorer this doesn&rsquo;t seem work. You cannot even use the command line tool runas /u:administrator to run explorer.
Explorer.exe is a special task. It actually runs all the time and is responsible for the taskbar and other features on the Windows desktop, press CTRL+ALT+DEL right now and you will see explorer."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://www.salmanq.com/blog/"},{"@type":"ListItem","position":2,"name":"Why run as doesn’t work on explorer.exe?","item":"https://www.salmanq.com/blog/why-run-as-doesnt-work-on-explorer-exe/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Why run as doesn’t work on explorer.exe?","name":"Why run as doesn’t work on explorer.exe?","description":"You will notice in windows no matter how you want to \u0026ldquo;Run as\u0026rdquo; explorer.exe it will not work. Almost all programs you can right-click or hold CTRL and right click to get the run as option but with explorer this doesn\u0026rsquo;t seem work. You cannot even use the command line tool runas /u:administrator to run explorer.\nExplorer.exe is a special task. It actually runs all the time and is responsible for the taskbar and other features on the Windows desktop, press CTRL+ALT+DEL right now and you will see explorer.","keywords":["Uncategorized"],"articleBody":"You will notice in windows no matter how you want to “Run as” explorer.exe it will not work. Almost all programs you can right-click or hold CTRL and right click to get the run as option but with explorer this doesn’t seem work. You cannot even use the command line tool runas /u:administrator to run explorer.\nExplorer.exe is a special task. It actually runs all the time and is responsible for the taskbar and other features on the Windows desktop, press CTRL+ALT+DEL right now and you will see explorer.exe is running, you can also kill the process (don’t do it if you have important things going, but for the sake of experiment you can try) and you will notice your taskbar and your desktop will clear away. You can once again run the process by clicking File-\u003eNew Task-\u003eexplorer.exe\nThe reason why run as does not work with explorer is because when a new explorer instance wants to start it looks to the current desktop for an already running instance of explorer.exe to find out what needs to be done (for instance explore c:\\) once the new explorer knows what to do it takes over and the previous instance automatically unloads itself (they both share the same PID, we will talk about this more in detail some other time).\nSince the current explorer is running as “you” the user on the system the run as option cannot force a new user on an already running instance. And that’s why the run as feature does not work.\nA workaround to this problem is to run iexplore to explore the drives (almost all things explorer can do iexplore can). You can do something like:\nrunas /u:administrator \"c:\\program files\\internet explorer\\iexplore.exe\" You can run the above command from the cmd prompt and it will prompt you for the administrator password, once in you can then explore the system (simply type: C:\\) with administrative rights! Aaron Margosis at Microsoft also has some interesting thoughts on this if you want to read on.\n","wordCount":"336","inLanguage":"en","datePublished":"2005-02-23T20:54:39Z","dateModified":"2005-02-23T20:54:39Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.salmanq.com/blog/why-run-as-doesnt-work-on-explorer-exe/"},"publisher":{"@type":"Organization","name":"Salman Quazi","logo":{"@type":"ImageObject","url":"https://www.salmanq.com/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.salmanq.com/ accesskey=h title="Salman Quazi (Alt + H)">Salman Quazi</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.salmanq.com/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://github.com/splusq/ title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.linkedin.com/in/salmanquazi/ title=LinkedIn><span>LinkedIn</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.twitter.com/splusq title=Twitter><span>Twitter</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Why run as doesn’t work on explorer.exe?</h1><div class=post-meta><span title='2005-02-23 20:54:39 +0000 UTC'>February 23, 2005</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Me</div></header><div class=post-content><p>You will notice in windows no matter how you want to &ldquo;Run as&rdquo; explorer.exe it will not work. Almost all programs you can right-click or hold CTRL and right click to get the run as option but with explorer this doesn&rsquo;t seem work. You cannot even use the command line tool runas /u:administrator to run explorer.</p><p>Explorer.exe is a special task. It actually runs all the time and is responsible for the taskbar and other features on the Windows desktop, press CTRL+ALT+DEL right now and you will see explorer.exe is running, you can also kill the process (don&rsquo;t do it if you have important things going, but for the sake of experiment you can try) and you will notice your taskbar and your desktop will clear away. You can once again run the process by clicking File->New Task->explorer.exe</p><p>The reason why run as does not work with explorer is because when a new explorer instance wants to start it looks to the current desktop for an already running instance of explorer.exe to find out what needs to be done (for instance explore c:\) once the new explorer knows what to do it takes over and the previous instance automatically unloads itself (they both share the same PID, we will talk about this more in detail some other time).</p><p>Since the current explorer is running as &ldquo;you&rdquo; the user on the system the run as option cannot force a new user on an already running instance. And that&rsquo;s why the run as feature does not work.</p><p>A workaround to this problem is to run iexplore to explore the drives (almost all things explorer can do iexplore can). You can do something like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-batch data-lang=batch><span style=display:flex><span>runas /u:administrator <span style=color:#e6db74>&#34;c:\program files\internet explorer\iexplore.exe&#34;</span>
</span></span></code></pre></div><p>You can run the above command from the cmd prompt and it will prompt you for the administrator password, once in you can then explore the system (simply type: C:\) with administrative rights! Aaron Margosis at Microsoft also <a href=http://blogs.msdn.com/aaron_margosis/archive/2004/07/07/175488.aspx>has some interesting thoughts on this</a> if you want to read on.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.salmanq.com/tags/uncategorized/>Uncategorized</a></li></ul><nav class=paginav><a class=prev href=https://www.salmanq.com/blog/option-groups/><span class=title>« Prev</span><br><span>Option Groups</span></a>
<a class=next href=https://www.salmanq.com/blog/can-uis-produce-bugs/><span class=title>Next »</span><br><span>Can UIs produce bugs?</span></a></nav></footer><script src=https://utteranc.es/client.js repo=splusq/splusq.github.io issue-term=title theme=github-dark crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2023 <a href=https://www.salmanq.com/>Salman Quazi</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>