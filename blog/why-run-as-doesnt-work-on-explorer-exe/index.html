<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=generator content="Hugo 0.120.0"><meta name=viewport content="width=device-width,initial-scale=1"><title>Why run as doesn’t work on explorer.exe? &#183; Salman Quazi</title>
<meta name=description content><link type=text/css rel=stylesheet href=https://www.salmanq.com/css/print.css media=print><link type=text/css rel=stylesheet href=https://www.salmanq.com/css/poole.css><link type=text/css rel=stylesheet href=https://www.salmanq.com/css/syntax.css><link type=text/css rel=stylesheet href=https://www.salmanq.com/css/hyde.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700"><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png><style type=text/css>.sidebar-about h1{font-size:1.95rem;font-weight:400}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-K4WVH5P91F"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-K4WVH5P91F")</script></head><body class=theme-base-08><aside class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://www.salmanq.com/><h1>Salman Quazi</h1></a><p class=lead>Director of Engineering for Microsoft Azure OpenAI in Mountain View, CA.</p></div><nav><ul class=sidebar-nav><li><a href=https://www.salmanq.com/>Home</a></li><li><a href=/blog/>Blog</a></li><li><a href=https://github.com/splusq/>Github</a></li><li><a href=https://www.linkedin.com/in/salmanquazi/>LinkedIn</a></li><li><a href=https://www.twitter.com/splusq>Twitter</a></li></ul></nav><p>Opinions are my own.</p></div></aside><main class="content container"><div class=post><h1>Why run as doesn’t work on explorer.exe?</h1><time datetime=2005-02-23T20:54:39Z class=post-date>Wed, Feb 23, 2005</time><p>You will notice in windows no matter how you want to &ldquo;Run as&rdquo; explorer.exe it will not work. Almost all programs you can right-click or hold CTRL and right click to get the run as option but with explorer this doesn&rsquo;t seem work. You cannot even use the command line tool runas /u:administrator to run explorer.</p><p>Explorer.exe is a special task. It actually runs all the time and is responsible for the taskbar and other features on the Windows desktop, press CTRL+ALT+DEL right now and you will see explorer.exe is running, you can also kill the process (don&rsquo;t do it if you have important things going, but for the sake of experiment you can try) and you will notice your taskbar and your desktop will clear away. You can once again run the process by clicking File->New Task->explorer.exe</p><p>The reason why run as does not work with explorer is because when a new explorer instance wants to start it looks to the current desktop for an already running instance of explorer.exe to find out what needs to be done (for instance explore c:\) once the new explorer knows what to do it takes over and the previous instance automatically unloads itself (they both share the same PID, we will talk about this more in detail some other time).</p><p>Since the current explorer is running as &ldquo;you&rdquo; the user on the system the run as option cannot force a new user on an already running instance. And that&rsquo;s why the run as feature does not work.</p><p>A workaround to this problem is to run iexplore to explore the drives (almost all things explorer can do iexplore can). You can do something like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-batch data-lang=batch><span style=display:flex><span>runas /u:administrator <span style=color:#e6db74>&#34;c:\program files\internet explorer\iexplore.exe&#34;</span>
</span></span></code></pre></div><p>You can run the above command from the cmd prompt and it will prompt you for the administrator password, once in you can then explore the system (simply type: C:\) with administrative rights! Aaron Margosis at Microsoft also <a href=http://blogs.msdn.com/aaron_margosis/archive/2004/07/07/175488.aspx>has some interesting thoughts on this</a> if you want to read on.</p></div><h2>Comments</h2><script src=https://utteranc.es/client.js repo=splusq/splusq.github.io issue-term=title theme=github-light crossorigin=anonymous async></script></main></body></html>